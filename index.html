<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lumina Studio โ ูุญุฑุฑ ุงูุชุฏุฑุฌุงุช ุงููุญุชุฑู</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&family=IBM+Plex+Sans+Arabic:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
   <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body data-theme="dark" dir="rtl">

  <div class="ambience">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
  </div>

  <main class="app-container">
    
    <aside class="panel">
      <header>
        <div class="brand">
          <div class="logo-box">LS</div>
          <h1 data-i18n="appTitle">Lumina Studio</h1>
        </div>
        <div style="display: flex; gap: 8px;">
          <div class="lang-dropdown-container">
            <button id="langToggle" class="lang-toggle" title="ุชุจุฏูู ุงููุบุฉ">๐ AR</button>
            <div id="langDropdown" class="lang-dropdown-menu">
              <button data-lang="ar" class="lang-option active">๐ธ๐ฆ ุงูุนุฑุจูุฉ</button>
              <button data-lang="en" class="lang-option">๐บ๐ธ English</button>
              <button data-lang="fr" class="lang-option">๐ซ๐ท Franรงais</button>
              <button data-lang="es" class="lang-option">๐ช๐ธ Espaรฑol</button>
              <button data-lang="de" class="lang-option">๐ฉ๐ช Deutsch</button>
              <button data-lang="zh" class="lang-option">๐จ๐ณ ไธญๆ</button>
              <button data-lang="ja" class="lang-option">๐ฏ๐ต ๆฅๆฌ่ช</button>
              <button data-lang="ru" class="lang-option">๐ท๐บ ะัััะบะธะน</button>
              <button data-lang="tr" class="lang-option">๐น๐ท Tรผrkรงe</button>
              <button data-lang="pt" class="lang-option">๐ต๐น Portuguรชs</button>
              <button data-lang="hi" class="lang-option">๐ฎ๐ณ เคนเคฟเคจเฅเคฆเฅ</button>
              <button data-lang="ko" class="lang-option">๐ฐ๐ท ํ๊ตญ์ด</button>
              <button data-lang="it" class="lang-option">๐ฎ๐น Italiano</button>
            </div>
          </div>
          <button id="userAccountBtn" class="user-account-btn" title="ุญุณุงุจ ุงููุณุชุฎุฏู">
            <div class="user-avatar" id="userAvatar">๐ค</div>
            <span class="user-name" id="userName" data-i18n="signIn">ุชุณุฌูู ุงูุฏุฎูู</span>
          </button>
          <button id="themeToggle" class="btn-icon" title="ุชุจุฏูู ุงูุณูุฉ">
            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
          </button>
        </div>
      </header>

      <div class="sidebar-content arabic-text">
        <section>
          <div class="spread" style="margin-bottom:8px">
            <h2 data-i18n="smartGenerator">ูููุฏ ุงูุชูุงุบู</h2>
          </div>
          <div class="control-group">
            <label data-i18n="baseColor">ุงูููู ุงูุฃุณุงุณู</label>
            <div class="row" style="margin-bottom:12px">
              <div class="base-color-preview" id="baseColorPreview" style="background-color: #6366F1;">
                <input id="genBaseColor" type="color" value="#6366f1" class="base-color-picker-trigger">
              </div>
              <input id="genBaseHex" type="text" value="#6366F1" class="hex-input">
            </div>
            
            <label data-i18n="harmonyMode">ุนุฏุฏ ุงูุฃููุงู</label>
            <select id="genMode" style="margin-bottom:12px">
              <option value="random" data-i18n="randomCount">ุนุดูุงุฆู (2-5)</option>
              <option value="2" data-i18n="twoColors">ููููู</option>
              <option value="3" selected data-i18n="threeColors">3 ุฃููุงู</option>
              <option value="4" data-i18n="fourColors">4 ุฃููุงู</option>
              <option value="5" data-i18n="fiveColors">5 ุฃููุงู</option>
            </select>
            
            <label style="margin-top:12px" data-i18n="basePosition">ูููุน ุงูููู ุงูุฃุณุงุณู</label>
            <select id="basePosition" style="margin-bottom:12px">
              <option value="start" selected data-i18n="atStart">ูู ุงูุจุฏุงูุฉ</option>
              <option value="end" data-i18n="atEnd">ูู ุงูููุงูุฉ</option>
              <option value="middle" data-i18n="inMiddle">ูู ุงูููุชุตู</option>
              <option value="random" data-i18n="randomPosition">ุนุดูุงุฆู</option>
            </select>
            
            <button id="btnSmartGenerate" class="btn btn-primary" style="width:100%" data-i18n="generatePalette">ุฅูุดุงุก ุชูุงุบู ุฌุฏูุฏ</button>
          </div>
        </section>

        <section>
          <div class="spread" style="margin-bottom:8px">
            <h2 data-i18n="colorStops">ููุงุท ุงูุฃููุงู</h2>
            <div style="display:flex; gap:8px">
               <button id="btnRandom" class="btn-icon" title="ุนุดูุงุฆู ููู" data-i18n-title="randomize">๐ฒ</button>
               <button id="btnAddColor" class="btn-icon" title="ุฅุถุงูุฉ ููุทุฉ" data-i18n-title="addStop">โ</button>
            </div>
          </div>
          
          <div id="colorList" class="color-stack">
            </div>
        </section>

        <section>
           <h2 data-i18n="configuration">ุงูุฅุนุฏุงุฏุงุช</h2>
           <div class="control-group">
             <div class="spread">
               <label data-i18n="stepsPrecision">ุงูุฎุทูุงุช / ุงูุฏูุฉ</label>
               <span id="stepsVal" class="muted font-mono">15</span>
             </div>
             
             <div class="steps-controls">
               <button id="stepsDecrease" class="step-btn">โ</button>
               <div class="steps-slider-container">
                 <input id="stepsInput" type="range" min="2" max="100" value="15">
               </div>
               <button id="stepsIncrease" class="step-btn">+</button>
             </div>

             <div class="spread" style="margin-top:16px">
               <label for="checkVivid" style="margin:0; cursor:pointer" data-i18n="vividMode">ุงููุถุน ุงูุญููู (LAB)</label>
               <input id="checkVivid" type="checkbox" class="toggle">
             </div>
             <p class="muted" style="margin-top:8px; font-size:0.75rem; line-height:1.4" data-i18n="vividDescription">ุงุณุชููุงุก ููุญุฏ ุฅุฏุฑุงููุงู ูููุน 'ุงูููุงุทู ุงูุฑูุงุฏูุฉ ุงูููุชุฉ' ูู ุงูุชุฏุฑุฌุงุช.</p>
           </div>
        </section>
      </div>
    </aside>

    <section class="preview-section">
      <div class="toolbar">
        <div class="row">
          <button id="openPresetsBtn" class="btn btn-ghost" data-i18n="gallery">ุงููุนุฑุถ</button>
          <button id="openBreakdownBtn" class="btn btn-ghost" data-i18n="analyze">ุชุญููู</button>
          <button id="saveGradientBtn" class="btn btn-ghost" data-i18n="saveGradient">ุญูุธ ุงูุชุฏุฑุฌ</button>
        </div>
        
        <div class="dropdown-container">
          <button id="btnExportToggle" class="btn btn-primary" data-i18n="downloadExport">ุชูุฒูู / ุชุตุฏูุฑ</button>
          <div id="exportMenu" class="dropdown-menu">
             <button id="actCopyCSS" class="menu-item" data-i18n="copyCSS">๐ ูุณุฎ CSS</button>
             <button id="actCopyTailwind" class="menu-item" data-i18n="copyTailwind">๐จ ูุณุฎ Tailwind</button>
             <hr style="border:0; border-top:1px solid var(--border-subtle); margin:4px 0">
             <button id="actDownloadCSS" class="menu-item" data-i18n="downloadCSS">๐ ุชูุฒูู .CSS</button>
             <button id="actDownloadPNG" class="menu-item" data-i18n="downloadPNG">๐ผ๏ธ ุชูุฒูู .PNG</button>
          </div>
        </div>
      </div>

      <div class="canvas-wrapper">
        <div id="previewBox" role="img" aria-label="ูุนุงููุฉ ุงูุชุฏุฑุฌ"></div>
        <div class="code-floater" id="cssPreviewTrigger" title="ุงููุฑ ูููุณุฎ" data-i18n-title="clickToCopy">
          <span id="cssPreviewText" style="opacity:0.8">linear-gradient(...)</span>
          <span style="opacity:0.5; font-size:0.75rem; margin-left:12px" data-i18n="clickToCopy">ุงููุฑ ูููุณุฎ</span>
        </div>
      </div>

      <div>
        <div class="spread" style="margin-bottom:8px">
          <h2 data-i18n="gradientSpectrum">ุทูู ุงูุชุฏุฑุฌ</h2>
          <span class="muted" style="font-size:0.75rem" data-i18n="spectrumHint">ูุฑุฑ ููุชุญุฏูุฏุ ุงููุฑ ูููุณุฎ</span>
        </div>
        <div id="stepsGrid" class="steps-strip"></div>
      </div>
    </section>

  </main>

  <div id="presetsModal" class="modal-overlay">
    <div class="modal-card">
      <div class="modal-header">
        <h3 data-i18n="gradientGallery">ูุนุฑุถ ุงูุชุฏุฑุฌุงุช</h3>
        <button class="btn-icon close-modal">โ</button>
      </div>
      <div class="modal-body">
        <h4 style="margin-bottom: 12px;" data-i18n="builtinGradients">ุงูุชุฏุฑุฌุงุช ุงููุถููุฉ</h4>
        <div id="presetsGrid" class="preset-grid"></div>
        
        <div class="user-gradients-section">
          <div class="spread">
            <h4 style="margin-bottom: 12px;" data-i18n="mySavedGradients">ุชุฏุฑุฌุงุชู ุงููุญููุธุฉ</h4>
            <button id="clearSavedGradients" class="btn btn-ghost btn-small" style="font-size: 0.75rem;" data-i18n="clearAll">ูุณุญ ุงููู</button>
          </div>
          <div id="userGradientsGrid" class="user-gradients-grid">
            <!-- User saved gradients will appear here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="breakdownModal" class="modal-overlay">
    <div class="modal-card" style="max-width:600px">
      <div class="modal-header">
        <h3 data-i18n="colorAnalysis">ุชุญููู ุงูุฃููุงู</h3>
        <button class="btn-icon close-breakdown">โ</button>
      </div>
      <div class="modal-body">
        <div id="breakGrid" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(60px,1fr)); gap:8px"></div>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div id="authModal" class="modal-overlay">
    <div class="modal-card" style="max-width: 400px;">
      <div class="modal-header">
        <h3 id="authModalTitle" data-i18n="signIn">ุชุณุฌูู ุงูุฏุฎูู</h3>
        <button class="btn-icon close-auth-modal">โ</button>
      </div>
      <div class="modal-body arabic-text">
        <div class="auth-error" id="authError"></div>
        
        <div class="auth-form" id="signInForm">
          <div class="auth-form-header">
            <h3 data-i18n="welcomeBack">ูุฑุญุจุงู ุจุนูุฏุชู</h3>
            <p data-i18n="signInToContinue">ุณุฌู ุงูุฏุฎูู ูููุชุงุจุนุฉ ุฅูู Lumina Studio</p>
          </div>
          
          <div class="form-group">
            <label for="signInEmail" data-i18n="emailAddress">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" id="signInEmail" placeholder="example@email.com">
          </div>
          
          <div class="form-group">
            <label for="signInPassword" data-i18n="password">ูููุฉ ุงููุฑูุฑ</label>
            <input type="password" id="signInPassword" placeholder="โขโขโขโขโขโขโขโข">
          </div>
          
          <div class="form-actions">
            <button id="signInBtn" class="btn btn-primary" data-i18n="signIn">
              <span class="btn-text">ุชุณุฌูู ุงูุฏุฎูู</span>
              <span class="spinner" style="display: none;"></span>
            </button>
            
            <div class="auth-divider">
              <span data-i18n="orContinueWith">ุฃู ุชุงุจุน ุจุงุณุชุฎุฏุงู</span>
            </div>
            
            <button id="googleSignInBtn" class="google-signin-btn">
              <svg class="google-icon" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
              </svg>
              <span data-i18n="signInWithGoogle">ุชุณุฌูู ุงูุฏุฎูู ุจูุงุณุทุฉ Google</span>
            </button>
          </div>
          
          <div class="auth-switch">
            <span data-i18n="dontHaveAccount">ููุณ ูุฏูู ุญุณุงุจุ</span>
            <a id="switchToSignUp" data-i18n="signUp">ุฅูุดุงุก ุญุณุงุจ</a>
          </div>
        </div>
        
        <div class="auth-form" id="signUpForm" style="display: none;">
          <div class="auth-form-header">
            <h3 data-i18n="createAccount">ุฅูุดุงุก ุญุณุงุจ</h3>
            <p data-i18n="joinLuminaStudio">ุงูุถู ุฅูู Lumina Studio ูุญูุธ ุนููู</p>
          </div>
          
          <div class="form-group">
            <label for="signUpName" data-i18n="fullName">ุงูุงุณู ุงููุงูู</label>
            <input type="text" id="signUpName" placeholder="ุงูุงุณู ุงููุงูู">
          </div>
          
          <div class="form-group">
            <label for="signUpEmail" data-i18n="emailAddress">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" id="signUpEmail" placeholder="example@email.com">
          </div>
          
          <div class="form-group">
            <label for="signUpPassword" data-i18n="password">ูููุฉ ุงููุฑูุฑ</label>
            <input type="password" id="signUpPassword" placeholder="โขโขโขโขโขโขโขโข">
          </div>
          
          <div class="form-group">
            <label for="signUpConfirmPassword" data-i18n="confirmPassword">ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ</label>
            <input type="password" id="signUpConfirmPassword" placeholder="โขโขโขโขโขโขโขโข">
          </div>
          
          <div class="form-actions">
            <button id="signUpBtn" class="btn btn-primary" data-i18n="createAccount">
              <span class="btn-text">ุฅูุดุงุก ุญุณุงุจ</span>
              <span class="spinner" style="display: none;"></span>
            </button>
            
            <div class="auth-divider">
              <span data-i18n="orContinueWith">ุฃู ุชุงุจุน ุจุงุณุชุฎุฏุงู</span>
            </div>
            
            <button id="googleSignUpBtn" class="google-signin-btn">
              <svg class="google-icon" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
              </svg>
              <span data-i18n="signUpWithGoogle">ุงูุชุณุฌูู ุจูุงุณุทุฉ Google</span>
            </button>
          </div>
          
          <div class="auth-switch">
            <span data-i18n="alreadyHaveAccount">ูุฏูู ุญุณุงุจ ุจุงููุนูุ</span>
            <a id="switchToSignIn" data-i18n="signIn">ุชุณุฌูู ุงูุฏุฎูู</a>
          </div>
        </div>
        
        <div class="auth-form" id="userProfile" style="display: none;">
          <div class="auth-form-header">
            <h3 id="profileUserName">ุงูููู ุงูุดุฎุตู</h3>
            <p id="profileUserEmail">user@example.com</p>
          </div>
          
          <div class="form-group">
            <label for="profileName" data-i18n="fullName">ุงูุงุณู ุงููุงูู</label>
            <input type="text" id="profileName" placeholder="ุงูุงุณู ุงููุงูู">
          </div>
          
          <div class="form-group">
            <label for="profileEmail" data-i18n="emailAddress">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" id="profileEmail" placeholder="example@email.com">
          </div>
          
          <div class="form-actions">
            <button id="updateProfileBtn" class="btn btn-primary" data-i18n="updateProfile">
              <span class="btn-text">ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู</span>
              <span class="spinner" style="display: none;"></span>
            </button>
            <button id="signOutBtn" class="btn btn-ghost" data-i18n="signOut">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
          </div>
          
          <div class="auth-switch">
            <span data-i18n="accountSynced">ุจูุงูุงุชู ูุชุฒุงููุฉ ุชููุงุฆูุงู ูุน ุญุณุงุจู</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast">ุชู ุชูููุฐ ุงูุฅุฌุฑุงุก</div>
  <canvas id="exportCanvas" style="display:none"></canvas>

  <script src="app.js"></script>
</body>
</html>